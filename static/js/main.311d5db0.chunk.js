(this.webpackJsonpymap=this.webpackJsonpymap||[]).push([[0],{188:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(25),a=n.n(i),o=(n(75),n(3)),s=n(4),c=n(6),d=n(5),l=(n(76),n(65)),p=n(0),u=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"initYandexMaps",value:function(e){this.map=e}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"YPath",style:{height:"100%",width:"100%"},children:Object(p.jsx)(l.a,{id:"map",apiSrc:"https://api-maps.yandex.ru/2.1/?lang=en_RU",init:this.initYandexMaps.bind(this)})})}}]),n}(r.Component),h=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function m(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a.a.render(Object(p.jsx)(u,{}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/react-yandex-map",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/react-yandex-map","/service-worker.js");h?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):m(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):m(e)}))}}()},65:function(e,t,n){"use strict";(function(e){var r=n(3),i=n(4),a=n(6),o=n(5),s=n(1),c=n(66),d=n.n(c),l=n(70),p=n(69),u=n(0),h=0,m=function(t){Object(a.a)(s,t);var n=Object(o.a)(s);function s(e){var t;return Object(r.a)(this,s),(t=n.call(this,e)).state={marks:[]},t.placemarks=[],t}return Object(i.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=this;window.initMap=this.initMap,Object(p.a)(this.props.apiSrc).then((function(){window.ymaps.ready((function(){var n=new window.ymaps.Map(t.refs.map.id,{center:[56.735951,38.853323],zoom:16,controls:[],autoFitToViewport:"always"});e.map=n,n.events.add("click",e.clickMap.bind(e)),"function"===typeof t.props.init&&t.props.init(n),e.renderPolygon()}))}))}},{key:"clickMap",value:function(e){var t=this,n=e.get("coords"),r="";window.ymaps.geocode(n,{results:1}).then((function(e){var t=e.geoObjects.get(0);r=t?t.properties.get("name"):""})).catch((function(e){console.log("Couldn't detect address. "+e),r=""})).then((function(){t.addMark(r,n)}))}},{key:"getCenter",value:function(){if(this.map)return this.map.getCenter()}},{key:"renderPolygon",value:function(){if(this.map){var t=this.map;t.geoObjects.removeAll();var n=new e.ymaps.Polyline([],{},{strokeColor:"#00000088",strokeWidth:4,editorMaxPoints:0,editorMenuManager:function(e){return e.length=0,e}});this.polyline=n,n.editor.events.add("vertexdragend",this.edgeMove,this),t.geoObjects.add(n),n.editor.startEditing()}}},{key:"edgeMove",value:function(e){var t=e.get("vertexModel"),n=this.state.marks.slice(),r=t.getIndex(),i=n[r];n[r]={id:i.id,val:i.val,coords:t.geometry.getCoordinates()},this.setState({marks:n})}},{key:"renderMark",value:function(e,t){if(this.polyline)if(this.polyline.geometry.set(t,e.coords),this.placemarks[e.id])this.placemarks[e.id].geometry.setCoordinates(e.coords),this.placemarks[e.id].balloon.setData(e.val);else{var n=new window.ymaps.Placemark(e.coords,{balloonContent:e.val});this.placemarks[e.id]=n,this.map.geoObjects.add(n)}}},{key:"getMap",value:function(){return this.map}},{key:"moveMark",value:function(e,t){var n=this.state.marks[e];this.setState(d()(this.state,{marks:{$splice:[[e,1],[t,0,n]]}}))}},{key:"addMark",value:function(e,t){var n=this.state.marks.slice();e||(e="Item "+(h+1)),t||(t=this.getCenter()),n.push({id:"mark"+ ++h,val:e,coords:t}),this.setState({marks:n})}},{key:"delMark",value:function(e){var t=this.state.marks[e];this.map.geoObjects.remove(this.placemarks[t.id]),delete this.placemarks[t.id];var n=this.state.marks.slice();n.splice(e,1),this.polyline.geometry.splice(e,1),this.setState({marks:n})}},{key:"render",value:function(){return Object(u.jsxs)("div",{style:{height:"100%",width:"100%"},children:[Object(u.jsx)("div",{className:"YMap",id:this.props.id,ref:"map",style:{height:"100%",width:"100%"}}),Object(u.jsx)(l.a,{getMap:this.getMap.bind(this),marks:this.state.marks,moveMark:this.moveMark.bind(this),addMark:this.addMark.bind(this),delMark:this.delMark.bind(this),renderMark:this.renderMark.bind(this)}),"))"]})}}]),s}(s.Component);t.a=m}).call(this,n(9))},69:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=null;function i(t){return t=t||"https://api-maps.yandex.ru/2.1/?lang=en_RU",r=r||new Promise((function(e,n){var r=document.createElement("script");r.type="text/javascript",r.src=t,r.onload=e,r.onerror=function(e){return n(e)},document.body.appendChild(r)})).then((function(){var n=function(e){var t=RegExp("[\\?&]ns=([^&#]*)").exec(e);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}(t);return n&&"ymaps"!==n&&(0,eval)("var ymaps = "+n+";"),new Promise((function(t){if(!e.ymaps)throw new Error("Failed to find ymaps in the global scope");if(!e.ymaps.ready)throw new Error("ymaps.ready is missing");return window.ymaps.ready(t)}))}))}}).call(this,n(9))},70:function(e,t,n){"use strict";var r=n(3),i=n(4),a=n(6),o=n(5),s=n(1),c=n(14),d=n(68),l=n.n(d),p=n(39),u=n(25),h=n(0),m={border:"1px dashed gray",padding:"0.5rem 1rem",marginBottom:".5rem",backgroundColor:"white",cursor:"move",position:"relative"},k={width:"30px",height:"30px",backgroundColor:"white",cursor:"pointer",position:"absolute",top:"2px",right:"2px",border:"2px dashed red"},f="mark",v={hover:function(e,t,n){var r=t.getItem().index,i=e.index;if(r!==i){var a=Object(u.findDOMNode)(n).getBoundingClientRect(),o=(a.bottom-a.top)/2,s=t.getClientOffset().y-a.top;r<i&&s<o||r>i&&s>o||(e.moveMark(r,i),t.getItem().index=i)}}},g=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"shouldComponentUpdate",value:function(e,t,n){return e.mark.id!==this.props.mark.id||e.mark.coords[0]!==this.props.mark.coords[0]||e.mark.coords[1]!==this.props.mark.coords[1]||e.index!==this.props.index||!0===e.isDragging||!0===this.props.isDragging}},{key:"render",value:function(){var e=this,t=this.props,n=t.text,r=t.isDragging?0:1;return(0,t.connectDragSource)((0,t.connectDropTarget)(Object(h.jsxs)("div",{style:Object(p.a)(Object(p.a)({},m),{},{opacity:r}),children:[n," ",Object(h.jsx)("button",{onClick:function(t){e.props.deleteMark(e.props.index),t.preventDefault()},style:k,children:"x"})]})))}}]),n}(s.Component),b=Object(c.DropTarget)(f,v,(function(e){return{connectDropTarget:e.dropTarget()}}))(Object(c.DragSource)(f,{beginDrag:function(e){return{id:e.id,index:e.index}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(g)),y=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"renderMapMark",value:function(){this.props.renderMark(this.props.mark,this.props.index)}},{key:"render",value:function(){return this.renderMapMark(),null}}]),n}(s.Component),x={float:"left",zIndex:100,top:"10px",left:"10px",position:"absolute",border:"2px dashed green",minHeight:"40px",padding:"3px",overflowY:"scroll",maxHeight:"95%"},j={float:"left",width:"160px",height:"19px",marginBottom:"0.5rem"},M={float:"left",width:30,height:25,cursor:"pointer"},w=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentWillMount",value:function(){this.setState({txt:""})}},{key:"moveMark",value:function(e,t){this.props.moveMark&&this.props.moveMark(e,t)}},{key:"btnClick",value:function(){this.props.addMark&&this.props.addMark(this.refs.txtMark.value)}},{key:"txtChange",value:function(e){this.setState({txt:e.target.value})}},{key:"deleteMark",value:function(e){this.props.delMark&&this.props.delMark(e)}},{key:"render",value:function(){var e=this,t=this.props.marks;return Object(h.jsxs)("div",{className:"MarksList",style:x,children:[Object(h.jsxs)("div",{style:{},children:[Object(h.jsx)("input",{type:"text",id:"txtMark",ref:"txtMark",style:j,onChange:this.txtChange.bind(this)},"txtMark"),Object(h.jsx)("button",{ref:"btnAdd",id:"btnAdd",disabled:!this.state.txt,onClick:this.btnClick.bind(this),style:M,children:"+"})]}),Object(h.jsxs)("div",{style:{clear:"both"},children:[t.map((function(t,n){return Object(h.jsx)(b,{index:n,id:t.id,text:t.val,moveMark:e.moveMark.bind(e),deleteMark:e.deleteMark.bind(e),mark:t,renderMark:e.props.renderMark},t.id)})),t.map((function(t,n){return Object(h.jsx)(y,{index:n,id:t.id,text:t.val,mark:t,renderMark:e.props.renderMark},t.id)}))]})]})}}]),n}(s.Component);t.a=Object(c.DragDropContext)(l.a)(w)},75:function(e,t,n){},76:function(e,t,n){}},[[188,1,2]]]);
//# sourceMappingURL=main.311d5db0.chunk.js.map